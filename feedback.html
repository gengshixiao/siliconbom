<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æäº¤åé¦ˆ - SiliconBom ç¡…å®</title>
    <style>
        :root {
            --bg-color: #F8FAFC;
            --trace-active: #6DD5E8;
            --text-main: #334155;
            --text-secondary: #64748B;
            --border-color: #E2E8F0;
            --primary-color: #6DD5E8;
            --primary-hover: #4DB6AC;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'PingFang SC', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#E2E8F0 1px, transparent 1px);
            background-size: 30px 30px;
            height: 100vh;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* é®ç½©å±‚ */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        /* å¼¹çª—å®¹å™¨ */
        .feedback-modal {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 90vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
            z-index: 1001;
        }

        /* å¼¹çª—å¤´éƒ¨ */
        .modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-title-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            object-fit: cover;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background-color 0.2s ease;
            font-size: 20px;
            color: var(--text-secondary);
        }

        .close-btn:hover {
            background-color: #F1F5F9;
        }

        /* å¼¹çª—å†…å®¹ */
        .modal-content {
            padding: 24px;
            flex: 1;
            overflow-y: auto;
        }

        .question-text {
            font-size: 14px;
            color: var(--text-main);
            margin-bottom: 16px;
            font-weight: 500;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .question-icon {
            width: 20px;
            height: 20px;
            flex-shrink: 0;
            color: var(--trace-active);
        }

        /* æ–‡æœ¬è¾“å…¥æ¡† */
        .feedback-textarea {
            width: 100%;
            min-height: 120px;
            padding: 12px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-main);
            font-family: inherit;
            resize: vertical;
            transition: border-color 0.2s ease;
            background: #fff;
        }

        .feedback-textarea:focus {
            outline: none;
            border-color: var(--trace-active);
            box-shadow: 0 0 0 3px rgba(109, 213, 232, 0.1);
        }

        .feedback-textarea::placeholder {
            color: var(--text-secondary);
        }

        /* æ ‡ç­¾åŒºåŸŸ */
        .tags-section {
            margin-top: 16px;
            margin-bottom: 20px;
        }

        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
        }

        .tag-item {
            padding: 6px 14px;
            border: 1px solid var(--border-color);
            border-radius: 20px;
            font-size: 13px;
            color: var(--text-main);
            background: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
        }

        .tag-item:hover {
            border-color: var(--trace-active);
            background: #F0FDFF;
        }

        .tag-item.selected {
            background: linear-gradient(135deg, var(--trace-active) 0%, #4DB6AC 100%);
            border-color: var(--trace-active);
            color: #fff;
        }

        /* å›¾ç‰‡ä¸Šä¼ åŒºåŸŸ */
        .upload-section {
            margin-top: 20px;
        }

        .upload-hint {
            font-size: 13px;
            color: var(--text-secondary);
            margin-bottom: 12px;
        }

        .upload-area {
            display: flex;
            gap: 12px;
            flex-wrap: wrap;
        }

        .upload-btn {
            width: 80px;
            height: 80px;
            border: 2px dashed var(--border-color);
            border-radius: 8px;
            background: #F8FAFC;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.2s ease;
            position: relative;
            overflow: hidden;
        }

        .upload-btn:hover {
            border-color: var(--trace-active);
            background: #F0FDFF;
        }

        .upload-btn-icon {
            font-size: 32px;
            color: var(--text-secondary);
        }

        .upload-btn input[type="file"] {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            opacity: 0;
            cursor: pointer;
        }

        /* å›¾ç‰‡é¢„è§ˆ */
        .image-preview {
            position: relative;
            width: 80px;
            height: 80px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .image-preview img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .image-remove {
            position: absolute;
            top: 4px;
            right: 4px;
            width: 20px;
            height: 20px;
            background: rgba(0, 0, 0, 0.6);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            color: #fff;
            font-size: 12px;
            transition: background-color 0.2s ease;
        }

        .image-remove:hover {
            background: rgba(0, 0, 0, 0.8);
        }

        /* å¼¹çª—åº•éƒ¨ */
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background: #FAFBFC;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-cancel {
            background: #fff;
            color: var(--text-main);
            border: 1px solid var(--border-color);
        }

        .btn-cancel:hover {
            background: #F8FAFC;
            border-color: #CBD5E1;
        }

        .btn-submit {
            background: linear-gradient(135deg, var(--trace-active) 0%, #4DB6AC 100%);
            color: #fff;
        }

        .btn-submit:hover {
            background: linear-gradient(135deg, #4DB6AC 0%, var(--trace-active) 100%);
            box-shadow: 0 4px 12px rgba(109, 213, 232, 0.3);
        }

        .btn-submit:disabled {
            background: #CBD5E1;
            cursor: not-allowed;
        }
    </style>
</head>
<body>
    <div class="modal-overlay">
        <div class="feedback-modal">
            <!-- å¤´éƒ¨ -->
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="https://chat-web-1253214834.cos.ap-beijing.myqcloud.com/image/a98360672e312beb0fcc5fdaaf57a568.png" alt="ç¡…å®" class="modal-title-icon">
                    <span>ç”¨æˆ·åé¦ˆ</span>
                </h2>
                <button class="close-btn" id="closeBtn">Ã—</button>
            </div>

            <!-- å†…å®¹ -->
            <div class="modal-content">
                <div class="question-text">
                    <svg class="question-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <circle cx="12" cy="12" r="10"></circle>
                        <path d="M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3"></path>
                        <line x1="12" y1="17" x2="12.01" y2="17"></line>
                    </svg>
                    <span>ä¸ç¡…å®åä½œæ—¶é‡åˆ°äº†ä»€ä¹ˆé—®é¢˜?</span>
                </div>
                
                <textarea 
                    class="feedback-textarea" 
                    id="feedbackText"
                    placeholder="ç•…æ‰€æ¬²è¨€ï¼ŒæœŸå¾…ä½ çš„çœŸçŸ¥ç¼è§"
                ></textarea>

                <div class="tags-section">
                    <div class="tags-container">
                        <div class="tag-item" data-tag="ç‰©æ–™æ•°æ®ä¸å…¨">ğŸ“Š ç‰©æ–™æ•°æ®ä¸å…¨</div>
                        <div class="tag-item" data-tag="èŠèµ·æ¥ç¬¨ç¬¨çš„">ğŸ½ èŠèµ·æ¥ç¬¨ç¬¨çš„</div>
                        <div class="tag-item" data-tag="ç³»ç»Ÿå»¶è¿Ÿ/åå­—æ…¢">ğŸ¢ ç³»ç»Ÿå»¶è¿Ÿ/åå­—æ…¢</div>
                        <div class="tag-item" data-tag="åŠŸèƒ½bug">ğŸ› åŠŸèƒ½bug</div>
                        <div class="tag-item" data-tag="é•¿å¾—ä¸‘">ğŸ¤¡ é•¿å¾—ä¸‘</div>
                    </div>
                </div>

                <div class="upload-section">
                    <div class="upload-hint">æœ‰å›¾æœ‰çœŸç›¸ï¼Œæ²¡å›¾é æƒ³è±¡ã€‚</div>
                    <div class="upload-area" id="uploadArea">
                        <div class="upload-btn" id="uploadBtn">
                            <span class="upload-btn-icon">+</span>
                            <input type="file" id="fileInput" accept="image/*" multiple>
                        </div>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨æŒ‰é’® -->
            <div class="modal-footer">
                <button class="btn btn-cancel" id="cancelBtn">å–æ¶ˆ</button>
                <button class="btn btn-submit" id="submitBtn">æäº¤åé¦ˆ</button>
            </div>
        </div>
    </div>

    <script>
        const closeBtn = document.getElementById('closeBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const submitBtn = document.getElementById('submitBtn');
        const feedbackText = document.getElementById('feedbackText');
        const fileInput = document.getElementById('fileInput');
        const uploadArea = document.getElementById('uploadArea');
        const uploadBtn = document.getElementById('uploadBtn');

        let uploadedImages = [];
        let selectedTags = [];

        // æ ‡ç­¾ç‚¹å‡»äº‹ä»¶
        document.querySelectorAll('.tag-item').forEach(tag => {
            tag.addEventListener('click', function() {
                const tagValue = this.getAttribute('data-tag');
                const index = selectedTags.indexOf(tagValue);
                
                if (index > -1) {
                    // å–æ¶ˆé€‰ä¸­
                    selectedTags.splice(index, 1);
                    this.classList.remove('selected');
                } else {
                    // é€‰ä¸­
                    selectedTags.push(tagValue);
                    this.classList.add('selected');
                }
            });
        });

        // å…³é—­å¼¹çª—
        function closeModal() {
            // è¿™é‡Œå¯ä»¥æ·»åŠ å…³é—­åŠ¨ç”»
            document.querySelector('.modal-overlay').style.display = 'none';
        }

        // å…³é—­æŒ‰é’®
        closeBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);

        // ç‚¹å‡»é®ç½©å±‚å…³é—­
        document.querySelector('.modal-overlay').addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // é˜»æ­¢å¼¹çª—å†…å®¹ç‚¹å‡»å…³é—­
        document.querySelector('.feedback-modal').addEventListener('click', function(e) {
            e.stopPropagation();
        });

        // æ–‡ä»¶é€‰æ‹©
        fileInput.addEventListener('change', function(e) {
            const files = Array.from(e.target.files);
            
            files.forEach(file => {
                if (file.type.startsWith('image/')) {
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const imageUrl = event.target.result;
                        uploadedImages.push({
                            file: file,
                            url: imageUrl
                        });
                        addImagePreview(imageUrl, uploadedImages.length - 1);
                    };
                    reader.readAsDataURL(file);
                }
            });

            // æ¸…ç©ºinputï¼Œå…è®¸é‡å¤é€‰æ‹©åŒä¸€æ–‡ä»¶
            this.value = '';
        });

        // æ·»åŠ å›¾ç‰‡é¢„è§ˆ
        function addImagePreview(imageUrl, index) {
            const preview = document.createElement('div');
            preview.className = 'image-preview';
            preview.innerHTML = `
                <img src="${imageUrl}" alt="é¢„è§ˆå›¾ç‰‡">
                <div class="image-remove" data-index="${index}">Ã—</div>
            `;
            
            // æ’å…¥åˆ°ä¸Šä¼ æŒ‰é’®ä¹‹å‰
            uploadArea.insertBefore(preview, uploadBtn);
            
            // åˆ é™¤å›¾ç‰‡
            preview.querySelector('.image-remove').addEventListener('click', function() {
                const idx = parseInt(this.getAttribute('data-index'));
                uploadedImages.splice(idx, 1);
                preview.remove();
                // é‡æ–°æ¸²æŸ“æ‰€æœ‰é¢„è§ˆï¼ˆæ›´æ–°ç´¢å¼•ï¼‰
                renderImagePreviews();
            });
        }

        // é‡æ–°æ¸²æŸ“å›¾ç‰‡é¢„è§ˆ
        function renderImagePreviews() {
            // æ¸…é™¤æ‰€æœ‰é¢„è§ˆ
            const previews = uploadArea.querySelectorAll('.image-preview');
            previews.forEach(preview => preview.remove());
            
            // é‡æ–°æ·»åŠ é¢„è§ˆ
            uploadedImages.forEach((item, index) => {
                addImagePreview(item.url, index);
            });
        }

        // ç²˜è´´å›¾ç‰‡
        document.addEventListener('paste', function(e) {
            const items = e.clipboardData.items;
            
            for (let i = 0; i < items.length; i++) {
                if (items[i].type.indexOf('image') !== -1) {
                    const blob = items[i].getAsFile();
                    const reader = new FileReader();
                    reader.onload = function(event) {
                        const imageUrl = event.target.result;
                        uploadedImages.push({
                            file: blob,
                            url: imageUrl
                        });
                        addImagePreview(imageUrl, uploadedImages.length - 1);
                    };
                    reader.readAsDataURL(blob);
                    break;
                }
            }
        });

        // æäº¤åé¦ˆ
        submitBtn.addEventListener('click', function() {
            const text = feedbackText.value.trim();
            
            if (!text && uploadedImages.length === 0) {
                alert('è¯·è¾“å…¥åé¦ˆå†…å®¹æˆ–ä¸Šä¼ å›¾ç‰‡');
                return;
            }

            // è¿™é‡Œå¯ä»¥æ·»åŠ æäº¤é€»è¾‘
            const feedbackData = {
                text: text,
                tags: selectedTags,
                images: uploadedImages.map(img => img.url)
            };

            console.log('æäº¤åé¦ˆ:', feedbackData);
            alert('åé¦ˆæäº¤æˆåŠŸï¼');
            
            // é‡ç½®è¡¨å•
            feedbackText.value = '';
            uploadedImages = [];
            selectedTags = [];
            renderImagePreviews();
            // é‡ç½®æ ‡ç­¾é€‰ä¸­çŠ¶æ€
            document.querySelectorAll('.tag-item').forEach(tag => {
                tag.classList.remove('selected');
            });
            
            // å…³é—­å¼¹çª—
            closeModal();
        });

        // é™åˆ¶ä¸Šä¼ å›¾ç‰‡æ•°é‡ï¼ˆæœ€å¤š9å¼ ï¼‰
        const maxImages = 9;
        const originalFileChange = fileInput.onchange;
        fileInput.addEventListener('change', function(e) {
            if (uploadedImages.length >= maxImages) {
                alert(`æœ€å¤šåªèƒ½ä¸Šä¼ ${maxImages}å¼ å›¾ç‰‡`);
                this.value = '';
                return;
            }
        });
    </script>
</body>
</html>
