<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>èŠå¤©è¾“å…¥æ¡† - ç¡…å®</title>
    <style>
        :root {
            --bg-color: #F8FAFC;
            --trace-active: #6DD5E8;
            --text-main: #334155;
            --text-secondary: #64748B;
            --border-color: #E2E8F0;
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Inter', 'PingFang SC', sans-serif;
        }

        body {
            background-color: var(--bg-color);
            background-image: radial-gradient(#E2E8F0 1px, transparent 1px);
            background-size: 30px 30px;
            min-height: 100vh;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }

        /* è¾“å…¥åŒºåŸŸå®¹å™¨ */
        .input-container {
            width: 100%;
            max-width: 800px;
            position: relative;
        }

        /* è¾“å…¥æ¡†åŒ…è£… */
        .search-wrapper {
            width: 100%;
            max-width: 800px;
            position: relative;
            background: #fff;
            border: 1px solid #E2E8F0;
            border-radius: 12px;
            padding: 16px 20px;
            transition: 0.3s;
            display: flex;
            flex-direction: column;
            gap: 12px;
        }
        
        .search-wrapper:focus-within { 
            border-color: var(--trace-active); 
            box-shadow: 0 0 0 3px rgba(109, 213, 232, 0.15); 
        }

        /* è¾“å…¥æ¡† */
        .input-editor {
            width: 100%;
            min-height: 40px;
            max-height: 200px;
            border: none; 
            background: transparent; 
            outline: none;
            font-size: 16px; 
            color: #333;
            line-height: 24px;
            overflow-y: auto;
            word-wrap: break-word;
        }
        
        .input-editor:empty::before {
            content: attr(data-placeholder);
            color: #94A3B8;
            font-size: 14px;
        }

        /* åº•éƒ¨æ“ä½œæ  */
        .input-actions {
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 8px;
            flex-shrink: 0;
        }

        .input-actions-left {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .input-actions-right {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .btn-attach,
        .btn-voice {
            width: 28px;
            height: 28px;
            border: none;
            background: transparent;
            cursor: pointer;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #94A3B8;
            transition: all 0.2s;
        }
        
        .btn-attach:hover,
        .btn-voice:hover {
            background: #F1F5F9;
            color: var(--trace-active);
        }
        
        .btn-attach svg,
        .btn-voice svg {
            width: 16px;
            height: 16px;
        }

        .send-button {
            width: 32px;
            height: 32px;
            border: none;
            background: var(--trace-active);
            color: white;
            border-radius: 8px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
            flex-shrink: 0;
        }
        
        .send-button:hover {
            background: #5BC5D8;
            transform: translateY(-1px);
        }
        
        .send-button:disabled {
            background: #94A3B8;
            cursor: not-allowed;
            transform: none;
        }
        
        .send-button svg {
            width: 16px;
            height: 16px;
        }

        /* ç ”å‘é£æ ¼é“­ç‰Œ */
        .mode-badge {
            display: flex;
            align-items: center;
            gap: 4px;
            padding: 4px 10px;
            border-radius: 16px;
            font-size: 11px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            border: 1.5px solid;
            white-space: nowrap;
        }

        .mode-badge:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.15);
        }

        /* ä¸åŒæ¨¡å¼çš„é“­ç‰Œæ ·å¼ */
        .mode-badge.balanced {
            background: linear-gradient(135deg, #6DD5E8 0%, #4DB6AC 100%);
            border-color: #6DD5E8;
            color: #fff;
        }

        .mode-badge.efficiency {
            background: linear-gradient(135deg, #F59E0B 0%, #F97316 100%);
            border-color: #F59E0B;
            color: #fff;
        }

        .mode-badge.inspiration {
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            border-color: #8B5CF6;
            color: #fff;
        }

        .mode-badge-icon {
            font-size: 14px;
        }

        /* è®¾ç½®å¼¹çª—é®ç½© */
        .modal-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
            z-index: 1000;
            display: none;
            align-items: center;
            justify-content: center;
        }

        .modal-overlay.show {
            display: flex;
        }

        /* è®¾ç½®å¼¹çª— */
        .settings-modal {
            background: #fff;
            border-radius: 16px;
            box-shadow: 0 20px 60px rgba(0, 0, 0, 0.3);
            width: 90%;
            max-width: 600px;
            max-height: 80vh;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            position: relative;
        }

        /* å¼¹çª—å¤´éƒ¨ */
        .modal-header {
            padding: 24px 24px 16px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .modal-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--text-main);
            display: flex;
            align-items: center;
            gap: 12px;
        }

        .modal-title-icon {
            width: 32px;
            height: 32px;
            border-radius: 8px;
            object-fit: cover;
        }

        .close-btn {
            width: 32px;
            height: 32px;
            border: none;
            background: transparent;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 8px;
            transition: background-color 0.2s ease;
            font-size: 20px;
            color: var(--text-secondary);
        }

        .close-btn:hover {
            background-color: #F1F5F9;
        }

        /* å¼¹çª—å†…å®¹ */
        .modal-content {
            flex: 1;
            overflow-y: auto;
            padding: 32px;
        }

        /* ç ”å‘åå¥½æ ·å¼ */
        .preferences-form {
            max-width: 100%;
        }

        .form-section {
            margin-bottom: 32px;
        }

        .form-section-title {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-main);
            margin-bottom: 12px;
        }

        /* æ ‡ç­¾å®¹å™¨ */
        .tags-container {
            display: flex;
            flex-wrap: wrap;
            gap: 12px;
        }

        /* æ ‡ç­¾é¡¹ */
        .preference-tag {
            position: relative;
            padding: 10px 20px;
            border: 1.5px solid var(--border-color);
            border-radius: 24px;
            font-size: 14px;
            color: var(--text-main);
            background: #fff;
            cursor: pointer;
            transition: all 0.2s ease;
            user-select: none;
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .preference-tag:hover {
            border-color: var(--trace-active);
            background: #F0FDFF;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(109, 213, 232, 0.15);
        }

        .preference-tag.selected {
            border-color: transparent;
            color: #fff;
        }

        /* ä¸åŒæ¨¡å¼çš„é¢œè‰² */
        .preference-tag[data-mode="balanced"].selected {
            background: linear-gradient(135deg, #6DD5E8 0%, #4DB6AC 100%);
            box-shadow: 0 4px 12px rgba(109, 213, 232, 0.3);
        }

        .preference-tag[data-mode="efficiency"].selected {
            background: linear-gradient(135deg, #F59E0B 0%, #F97316 100%);
            box-shadow: 0 4px 12px rgba(245, 158, 11, 0.3);
        }

        .preference-tag[data-mode="inspiration"].selected {
            background: linear-gradient(135deg, #8B5CF6 0%, #7C3AED 100%);
            box-shadow: 0 4px 12px rgba(139, 92, 246, 0.3);
        }

        .preference-tag-icon {
            font-size: 16px;
        }

        /* Tooltipæç¤º */
        .preference-tag-tooltip {
            position: absolute;
            top: calc(100% + 8px);
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.85);
            color: #fff;
            padding: 10px 14px;
            border-radius: 6px;
            font-size: 12px;
            line-height: 1.5;
            max-width: 320px;
            min-width: 240px;
            white-space: normal;
            pointer-events: none;
            opacity: 0;
            visibility: hidden;
            transition: all 0.2s ease;
            z-index: 10000;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.15);
        }

        .preference-tag-tooltip::after {
            content: '';
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            border: 6px solid transparent;
            border-bottom-color: rgba(0, 0, 0, 0.85);
        }

        .preference-tag:hover .preference-tag-tooltip {
            opacity: 1;
            visibility: visible;
        }

        /* å¤šè¡Œæ–‡æœ¬è¾“å…¥ */
        .preference-textarea {
            width: 100%;
            min-height: 180px;
            padding: 12px 16px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            font-size: 14px;
            color: var(--text-main);
            font-family: inherit;
            resize: vertical;
            transition: all 0.2s ease;
            background: #fff;
            line-height: 1.6;
        }

        .preference-textarea:focus {
            outline: none;
            border-color: var(--trace-active);
            box-shadow: 0 0 0 3px rgba(109, 213, 232, 0.1);
        }

        .preference-textarea::placeholder {
            color: #94A3B8;
            line-height: 1.6;
        }

        /* å¼¹çª—åº•éƒ¨ */
        .modal-footer {
            padding: 16px 24px;
            border-top: 1px solid var(--border-color);
            display: flex;
            justify-content: flex-end;
            gap: 12px;
            background: #FAFBFC;
        }

        .btn {
            padding: 10px 20px;
            border-radius: 8px;
            font-size: 14px;
            font-weight: 500;
            cursor: pointer;
            transition: all 0.2s ease;
            border: none;
        }

        .btn-cancel {
            background: #fff;
            color: var(--text-main);
            border: 1px solid var(--border-color);
        }

        .btn-cancel:hover {
            background: #F8FAFC;
            border-color: #CBD5E1;
        }

        .btn-save {
            background: linear-gradient(135deg, var(--trace-active) 0%, #4DB6AC 100%);
            color: #fff;
        }

        .btn-save:hover {
            background: linear-gradient(135deg, #4DB6AC 0%, var(--trace-active) 100%);
            box-shadow: 0 4px 12px rgba(109, 213, 232, 0.3);
        }

        /* æ»šåŠ¨æ¡æ ·å¼ */
        .modal-content::-webkit-scrollbar {
            width: 6px;
        }

        .modal-content::-webkit-scrollbar-thumb {
            background: #CBD5E1;
            border-radius: 3px;
        }

        .modal-content::-webkit-scrollbar-thumb:hover {
            background: #94A3B8;
        }
    </style>
</head>
<body>
    <!-- è¾“å…¥æ¡†åŒºåŸŸ -->
    <div class="input-container">
        <div class="search-wrapper">
            <div class="input-editor" id="messageInput" contenteditable="true" data-placeholder="è¯·æè¿°éœ€æ±‚ï¼Œè¾“å…¥@å¯è°ƒç”¨BOMæ¡£æ¡ˆ"></div>
            <div class="input-actions">
                <div class="input-actions-left">
                    <!-- ç ”å‘é£æ ¼é“­ç‰Œ -->
                    <div class="mode-badge balanced" id="modeBadge">
                        <span class="mode-badge-icon">âš–ï¸</span>
                        <span id="modeBadgeText">å‡è¡¡æ¨¡å¼</span>
                    </div>
                </div>
                <div class="input-actions-right">
                    <button class="btn-attach" type="button" aria-label="ä¸Šä¼ æ–‡ä»¶">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M21.44 11.05l-9.19 9.19a6 6 0 0 1-8.49-8.49l9.19-9.19a4 4 0 0 1 5.66 5.66l-9.2 9.19a2 2 0 0 1-2.83-2.83l8.49-8.48"></path>
                        </svg>
                    </button>
                    <button class="btn-voice" type="button" aria-label="è¯­éŸ³è¾“å…¥">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 1a3 3 0 0 0-3 3v8a3 3 0 0 0 6 0V4a3 3 0 0 0-3-3z"></path>
                            <path d="M19 10v2a7 7 0 0 1-14 0v-2"></path>
                            <line x1="12" y1="19" x2="12" y2="23"></line>
                            <line x1="8" y1="23" x2="16" y2="23"></line>
                        </svg>
                    </button>
                    <button class="send-button" id="sendButton">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22,2 15,22 11,13 2,9"/>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    </div>

    <!-- è®¾ç½®å¼¹çª— -->
    <div class="modal-overlay" id="modalOverlay">
        <div class="settings-modal">
            <!-- å¤´éƒ¨ -->
            <div class="modal-header">
                <h2 class="modal-title">
                    <img src="https://chat-web-1253214834.cos.ap-beijing.myqcloud.com/image/f4f1acead1b2b1cfc74946089e643749.png" alt="ç¡…å®" class="modal-title-icon">
                    <span>ç ”å‘åå¥½</span>
                </h2>
                <button class="close-btn" id="closeBtn">Ã—</button>
            </div>

            <!-- å†…å®¹ -->
            <div class="modal-content">
                <div class="preferences-form">
                    <!-- ç ”å‘é£æ ¼ -->
                    <div class="form-section">
                        <div class="form-section-title">ç ”å‘é£æ ¼</div>
                        <div class="tags-container">
                            <div class="preference-tag selected" data-mode="balanced">
                                <span class="preference-tag-icon">âš–ï¸</span>
                                <span>å‡è¡¡æ¨¡å¼</span>
                                <div class="preference-tag-tooltip">
                                    åœ¨ä»»åŠ¡æ·±åº¦å’Œæ—¶é—´ä¸Šåšäº†å¹³è¡¡ï¼Œé€‚ç”¨äºå¤§å¤šæ•°å·¥ç¨‹å¸ˆ
                                </div>
                            </div>
                            <div class="preference-tag" data-mode="efficiency">
                                <span class="preference-tag-icon">âš¡</span>
                                <span>æ•ˆç‡æ¨¡å¼</span>
                                <div class="preference-tag-tooltip">
                                    ç¡…å®å°†ä¸“æ³¨äºæ‰§è¡Œä½ å‘å‡ºçš„æŒ‡ä»¤ï¼Œé€Ÿåº¦æœ€å¿«ï¼Œä½†ä¸ä¼šå¸®ä½ æ€è€ƒè¿‡å¤šå†…å®¹
                                </div>
                            </div>
                            <div class="preference-tag" data-mode="inspiration">
                                <span class="preference-tag-icon">ğŸ’¡</span>
                                <span>å¯å‘æ¨¡å¼</span>
                                <div class="preference-tag-tooltip">
                                    ç¡…å®å°†ä½¿ç”¨æ›´å¤æ‚çš„æ¨¡å‹å’Œæ›´å¤šçš„æ•°æ®ä¸ä½ åä½œï¼Œç»“æœæ›´ä¸°å¯Œå’Œå…¨é¢ï¼Œä½†è€—æ—¶æ›´ä¹…
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- é€‰å‹åå¥½ -->
                    <div class="form-section">
                        <div class="form-section-title">é€‰å‹åå¥½</div>
                        <textarea 
                            class="preference-textarea" 
                            id="selectionPreference"
                            placeholder="æè¿°ä½ çš„é€‰å‹å€¾å‘ï¼Œä¾‹å¦‚ï¼š&#10;â€¢ åå¥½çš„å“ç‰Œï¼ˆTIã€ADIã€å›½äº§ç­‰ï¼‰&#10;â€¢ æŠ€æœ¯å‚æ•°è¦æ±‚ï¼ˆåŠŸè€—ã€ç²¾åº¦ã€é€Ÿåº¦ç­‰ï¼‰&#10;â€¢ åº”ç”¨åœºæ™¯ç‰¹ç‚¹ï¼ˆè½¦è§„ã€å·¥ä¸šã€æ¶ˆè´¹çº§ï¼‰&#10;â€¢ å…¶ä»–è€ƒè™‘å› ç´ "
                        ></textarea>
                    </div>
                </div>
            </div>

            <!-- åº•éƒ¨æŒ‰é’® -->
            <div class="modal-footer">
                <button class="btn btn-cancel" id="cancelBtn">å–æ¶ˆ</button>
                <button class="btn btn-save" id="saveBtn">ä¿å­˜</button>
            </div>
        </div>
    </div>

    <script>
        // æ¨¡å¼é…ç½®
        const modeConfig = {
            balanced: {
                icon: 'âš–ï¸',
                text: 'å‡è¡¡æ¨¡å¼',
                class: 'balanced'
            },
            efficiency: {
                icon: 'âš¡',
                text: 'æ•ˆç‡æ¨¡å¼',
                class: 'efficiency'
            },
            inspiration: {
                icon: 'ğŸ’¡',
                text: 'å¯å‘æ¨¡å¼',
                class: 'inspiration'
            }
        };

        // è·å–DOMå…ƒç´ 
        const modeBadge = document.getElementById('modeBadge');
        const modeBadgeText = document.getElementById('modeBadgeText');
        const modalOverlay = document.getElementById('modalOverlay');
        const closeBtn = document.getElementById('closeBtn');
        const cancelBtn = document.getElementById('cancelBtn');
        const saveBtn = document.getElementById('saveBtn');
        const preferenceTags = document.querySelectorAll('.preference-tag');
        const selectionPreference = document.getElementById('selectionPreference');

        // å½“å‰é€‰ä¸­çš„æ¨¡å¼
        let selectedMode = 'balanced';

        // ä»localStorageåŠ è½½ä¿å­˜çš„è®¾ç½®
        function loadSettings() {
            const savedMode = localStorage.getItem('developmentMode');
            const savedPreference = localStorage.getItem('selectionPreference');

            if (savedMode && modeConfig[savedMode]) {
                selectedMode = savedMode;
                updateModeBadge(savedMode);
                
                // æ›´æ–°å¼¹çª—ä¸­çš„é€‰ä¸­çŠ¶æ€
                preferenceTags.forEach(tag => {
                    tag.classList.remove('selected');
                    if (tag.getAttribute('data-mode') === savedMode) {
                        tag.classList.add('selected');
                    }
                });
            }

            if (savedPreference) {
                selectionPreference.value = savedPreference;
            }
        }

        // æ›´æ–°é“­ç‰Œæ˜¾ç¤º
        function updateModeBadge(mode) {
            const config = modeConfig[mode];
            modeBadge.className = `mode-badge ${config.class}`;
            modeBadge.querySelector('.mode-badge-icon').textContent = config.icon;
            modeBadgeText.textContent = config.text;
        }

        // ç‚¹å‡»é“­ç‰Œæ‰“å¼€è®¾ç½®å¼¹çª—
        modeBadge.addEventListener('click', function() {
            modalOverlay.classList.add('show');
        });

        // å…³é—­å¼¹çª—
        function closeModal() {
            modalOverlay.classList.remove('show');
        }

        closeBtn.addEventListener('click', closeModal);
        cancelBtn.addEventListener('click', closeModal);

        // ç‚¹å‡»é®ç½©å±‚å…³é—­
        modalOverlay.addEventListener('click', function(e) {
            if (e.target === this) {
                closeModal();
            }
        });

        // é˜»æ­¢å¼¹çª—å†…å®¹ç‚¹å‡»å…³é—­
        document.querySelector('.settings-modal').addEventListener('click', function(e) {
            e.stopPropagation();
        });

        // æ ‡ç­¾é€‰æ‹©ï¼ˆå•é€‰ï¼Œå¯å–æ¶ˆï¼‰
        preferenceTags.forEach(tag => {
            tag.addEventListener('click', function() {
                const mode = this.getAttribute('data-mode');
                
                // å¦‚æœç‚¹å‡»çš„æ˜¯å·²é€‰ä¸­çš„æ ‡ç­¾ï¼Œåˆ™å–æ¶ˆé€‰æ‹©
                if (selectedMode === mode) {
                    this.classList.remove('selected');
                    selectedMode = null;
                } else {
                    // ç§»é™¤æ‰€æœ‰æ ‡ç­¾çš„é€‰ä¸­çŠ¶æ€
                    preferenceTags.forEach(t => t.classList.remove('selected'));
                    // é€‰ä¸­å½“å‰æ ‡ç­¾
                    this.classList.add('selected');
                    selectedMode = mode;
                }
            });
        });

        // ä¿å­˜è®¾ç½®
        saveBtn.addEventListener('click', function() {
            const preference = selectionPreference.value.trim();

            // ä¿å­˜åˆ°localStorage
            if (selectedMode) {
                localStorage.setItem('developmentMode', selectedMode);
                updateModeBadge(selectedMode);
            } else {
                localStorage.removeItem('developmentMode');
            }

            if (preference) {
                localStorage.setItem('selectionPreference', preference);
            } else {
                localStorage.removeItem('selectionPreference');
            }

            // ç›´æ¥å…³é—­å¼¹çª—ï¼Œä¸æ˜¾ç¤ºalert
            closeModal();
        });

        // ESCé”®å…³é—­å¼¹çª—
        document.addEventListener('keydown', function(e) {
            if (e.key === 'Escape' && modalOverlay.classList.contains('show')) {
                closeModal();
            }
        });

        // é¡µé¢åŠ è½½æ—¶åŠ è½½è®¾ç½®
        loadSettings();
    </script>
</body>
</html>

