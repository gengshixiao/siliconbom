<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/png" href="https://chat-web-1253214834.cos.ap-beijing.myqcloud.com/image/a98360672e312beb0fcc5fdaaf57a568.png">
    <title>设计模式 - SiliconBom 硅宝</title>
    
    <!-- 引入公共CSS -->
    <link rel="stylesheet" href="css/variables.css">
    <link rel="stylesheet" href="css/common.css">
    <!-- 设计模式独立样式 -->
    <link rel="stylesheet" href="css/design-mode.css">
</head>
<body class="design-mode-body">
    <div class="design-mode-layout">
        <!-- 顶部工具栏 -->
        <div class="design-mode-topbar">
            <div class="design-mode-topbar-left">
                <button class="design-back-home-btn" id="backHomeBtn" title="返回硅宝首页">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M3 9l9-7 9 7v11a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z"/>
                        <polyline points="9 22 9 12 15 12 15 22"/>
                    </svg>
                    <span>硅宝</span>
                </button>
                <button class="design-panel-toggle" id="toggleLibraryBtn" title="切换设计库">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <rect x="3" y="3" width="18" height="18" rx="2"/>
                        <path d="M3 9h18M9 21V9"/>
                    </svg>
                </button>
            </div>
            
            <div class="design-mode-topbar-center">
                <div class="design-canvas-title-editable" id="designTitleEditable" contenteditable="false">STM32 电源切换模块</div>
            </div>
            
            <div class="design-mode-topbar-right">
                <button class="design-topbar-icon-btn" id="exportBtn" title="导出">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <path d="M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4"/>
                        <polyline points="7 10 12 15 17 10"/>
                        <line x1="12" y1="15" x2="12" y2="3"/>
                    </svg>
                </button>
                <button class="design-topbar-icon-btn" id="bomBtn" title="BOM">
                    <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                        <line x1="8" y1="6" x2="21" y2="6"/>
                        <line x1="8" y1="12" x2="21" y2="12"/>
                        <line x1="8" y1="18" x2="21" y2="18"/>
                        <line x1="3" y1="6" x2="3.01" y2="6"/>
                        <line x1="3" y1="12" x2="3.01" y2="12"/>
                        <line x1="3" y1="18" x2="3.01" y2="18"/>
                    </svg>
                </button>
                <button class="design-panel-toggle" id="toggleSiliconBtn" title="切换硅宝">
                    <img src="https://chat-web-1253214834.cos.ap-beijing.myqcloud.com/image/a98360672e312beb0fcc5fdaaf57a568.png" alt="硅宝" class="silicon-logo-icon">
                </button>
            </div>
        </div>

        <!-- 连线删除气泡 -->
        <div class="connection-delete-popup" id="connectionDeletePopup" style="display: none;">
            <button class="popup-delete-btn" id="deleteConnectionBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
                <span>删除</span>
            </button>
        </div>

        <!-- 组件操作气泡 -->
        <div class="component-actions-popup" id="componentActionsPopup" style="display: none;">
            <button class="popup-action-btn" id="alternativeBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M8 3H5a2 2 0 0 0-2 2v3m18 0V5a2 2 0 0 0-2-2h-3m0 18h3a2 2 0 0 0 2-2v-3M3 16v3a2 2 0 0 0 2 2h3"/>
                </svg>
                <span>替代料</span>
            </button>
            <button class="popup-action-btn" id="mentionBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <path d="M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2"/>
                    <circle cx="9" cy="7" r="4"/>
                    <path d="M22 21v-2a4 4 0 0 0-3-3.87M16 3.13a4 4 0 0 1 0 7.75"/>
                </svg>
                <span>引用</span>
            </button>
            <button class="popup-action-btn popup-delete-btn" id="deleteComponentBtn">
                <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                    <polyline points="3 6 5 6 21 6"/>
                    <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m3 0V4a2 2 0 0 1 2-2h4a2 2 0 0 1 2 2v2"/>
                </svg>
                <span>删除</span>
            </button>
            <!-- 替代料下拉框 -->
            <div class="alternatives-dropdown" id="alternativesDropdown" style="display: none;">
                <div class="alternative-option" data-part="STM32F103C8T6">
                    <div class="alternative-name">STM32F103C8T6 <span class="alternative-tag tag-high-compatible">高兼容</span></div>
                    <div class="alternative-desc">当前选择 - ST微电子，72MHz，64KB Flash，20KB RAM</div>
                </div>
                <div class="alternative-option" data-part="STM32F103R8T6">
                    <div class="alternative-name">STM32F103R8T6 <span class="alternative-tag tag-high-compatible">高兼容</span></div>
                    <div class="alternative-desc">ST微电子，72MHz，64KB Flash，20KB RAM，LQFP64</div>
                </div>
                <div class="alternative-option" data-part="GD32F103C8T6">
                    <div class="alternative-name">GD32F103C8T6 <span class="alternative-tag tag-cost-effective">性价比高</span></div>
                    <div class="alternative-desc">兆易创新，108MHz，64KB Flash，20KB RAM，兼容STM32</div>
                </div>
            </div>
        </div>

        <!-- 主内容区域 -->
        <div class="design-mode-content">
            <!-- 左侧：设计库面板 -->
            <aside class="design-library-panel" id="designLibraryPanel">
                <!-- 上半部分：设计库 -->
                <div class="design-library-section">
                    <div class="design-library-header">
                        <h2 class="design-library-title">设计库</h2>
                    </div>
                    <div class="design-library-search">
                        <input type="text" class="design-library-search-input" placeholder="搜索功能..." id="librarySearchInput">
                    </div>
                    <div class="design-library-content" id="libraryContent">
                        <!-- 元器件分类将通过JavaScript动态生成 -->
                    </div>
                </div>
                
                <!-- 下半部分：操作记录 -->
                <div class="design-library-activity">
                    <div class="design-library-activity-header">
                        <h3 class="design-library-activity-title">操作记录</h3>
                    </div>
                    <div class="design-library-activity-content" id="activityContent">
                        <!-- 操作记录将通过JavaScript动态生成 -->
                    </div>
                </div>
            </aside>

            <!-- 中间：设计画布 -->
            <section class="design-canvas-container">
                <div class="design-canvas-wrapper">
                    <div class="design-canvas" id="designCanvas">
                        <!-- 网格背景 -->
                        <svg class="canvas-grid" id="canvasGrid"></svg>
                        <!-- 连接线层 -->
                        <svg class="canvas-connections" id="canvasConnections"></svg>
                        <!-- 元器件层 -->
                        <div class="canvas-components" id="canvasComponents"></div>
                    </div>
                    <div class="canvas-zoom-controls">
                        <button class="canvas-zoom-btn" id="canvasZoomOut" title="缩小">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                        </button>
                        <div class="canvas-zoom-level" id="canvasZoomLevel">100%</div>
                        <button class="canvas-zoom-btn" id="canvasZoomIn" title="放大">
                            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                <line x1="12" y1="5" x2="12" y2="19"/>
                                <line x1="5" y1="12" x2="19" y2="12"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </section>

            <!-- 右侧：硅宝对话框 -->
            <aside class="design-copilot-panel" id="designCopilotPanel">
                <div class="copilot-header">
                    <h3 class="copilot-title">硅宝</h3>
                </div>
                <div class="copilot-messages" id="copilotMessages">
                    <!-- 消息内容将通过JavaScript动态生成 -->
                </div>
                <div class="copilot-input-wrapper">
                    <button class="copilot-example-btn" id="copilotExampleBtn" style="display: none;">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"/>
                            <polyline points="14 2 14 8 20 8"/>
                            <line x1="16" y1="13" x2="8" y2="13"/>
                            <line x1="16" y1="17" x2="8" y2="17"/>
                            <polyline points="10 9 9 9 8 9"/>
                        </svg>
                        <span>查看案例</span>
                    </button>
                    <div class="copilot-input" id="copilotInput" contenteditable="true" placeholder="询问一些内容..." data-placeholder="询问一些内容..."></div>
                    <button class="copilot-send-btn" id="copilotSendBtn">
                        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                            <line x1="22" y1="2" x2="11" y2="13"/>
                            <polygon points="22 2 15 22 11 13 2 9 22 2"/>
                        </svg>
                    </button>
                </div>
            </aside>
        </div>
    </div>

    <!-- 引入公共JavaScript（仅必要的） -->
    <script src="js/toast.js"></script>
    <!-- 设计模式独立逻辑 -->
    <script src="js/design-mode.js"></script>
</body>
</html>
